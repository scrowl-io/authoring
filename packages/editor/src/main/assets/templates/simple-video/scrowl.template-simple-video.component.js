"use strict";(self.webpackChunk_scrowl_template_simple_video=self.webpackChunk_scrowl_template_simple_video||[]).push([[755],{914:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ SimpleVideo)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(24);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_lazyload__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(530);\n/* harmony import */ var react_youtube__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(325);\n/* harmony import */ var react_vimeo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(232);\n/* harmony import */ var react_vimeo__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_vimeo__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react_dailymotion__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(490);\n\n\n\n\n\n\nconst SimpleVideo = ({ id, schema, ...props }) => {\n    const Scrowl = window['Scrowl'];\n    let classes = 'template-simple-video';\n    const Markdown = Scrowl.core.Markdown;\n    const editMode = props.editMode ? true : false;\n    const focusElement = editMode ? props.focusElement : null;\n    const contentId = `${id}-simple-video`;\n    const text = schema.content.text.value;\n    const textFocusCss = focusElement === 'text' && 'has-focus';\n    const videoAssetUrl = schema.content.videoAsset.content.assetUrl?.value;\n    const videoWebUrl = schema.content.videoAsset.content.webUrl?.value;\n    const bgLabel = schema.content.videoAsset.content.alt.value || '';\n    const bgFocusCss = focusElement === 'videoAsset.url' && 'has-focus';\n    const bgRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const alignment = schema.content.options.content.alignment.value;\n    const alignmentCss = alignment === 'right' ? 'right' : 'left';\n    const disableAnimations = schema.controlOptions.disableAnimations?.value;\n    const showProgressBar = disableAnimations\n        ? false\n        : schema.content.options.content.showProgress.value;\n    const showProgressRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(showProgressBar);\n    const slideProgress = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(0);\n    const [progressBarStyles, setProgressBarStyles] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({\n        width: showProgressBar ? '0%' : '100%',\n    });\n    // @ts-ignore\n    const [videoEnded, setVideoEnded] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    // const [player, setPlayer] = useState(null);\n    const videoService = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)('');\n    let videoId;\n    if (videoWebUrl) {\n        if (videoWebUrl.includes('youtube.com')) {\n            videoService.current = 'youtube';\n            videoId = videoWebUrl.replace('https://www.youtube.com/watch?v=', '');\n        }\n        if (videoWebUrl.includes('vimeo.com')) {\n            videoService.current = 'vimeo';\n            videoId = videoWebUrl.replace('https://vimeo.com/', '');\n        }\n        if (videoWebUrl.includes('dailymotion.com')) {\n            videoService.current = 'dailymotion';\n            videoId = videoWebUrl.replace('https://www.dailymotion.com/video/', '');\n        }\n    }\n    if (showProgressBar) {\n        classes += ' show-progress';\n    }\n    const handleFocusText = () => {\n        if (editMode) {\n            Scrowl.core.host.sendMessage({\n                type: 'focus',\n                field: 'text',\n            });\n        }\n    };\n    const handleFocusBg = () => {\n        if (editMode) {\n            Scrowl.core.host.sendMessage({\n                type: 'focus',\n                field: 'bgImage.url',\n            });\n        }\n    };\n    const handleSlideProgress = (ev) => {\n        if (disableAnimations) {\n            return;\n        }\n        slideProgress.current = ev.progress;\n        if (showProgressRef.current) {\n            setProgressBarStyles({\n                ...progressBarStyles,\n                width: `${ev.progress}%`,\n            });\n        }\n    };\n    const handleSlideEnd = () => {\n        if (disableAnimations) {\n            return;\n        }\n        slideProgress.current = 100;\n        if (!showProgressRef.current) {\n            return;\n        }\n        setProgressBarStyles({\n            ...progressBarStyles,\n            width: `100%`,\n        });\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        showProgressRef.current = showProgressBar;\n        setProgressBarStyles({\n            ...progressBarStyles,\n            width: showProgressBar ? `${slideProgress.current}%` : `100%`,\n        });\n    }, [showProgressBar]);\n    const handleVideoEnd = (ev) => {\n        const videoEnded = new CustomEvent('videoEnded', { detail: ev });\n        document.dispatchEvent(videoEnded);\n        console.log('custom event', videoEnded);\n    };\n    const onEnd = (ev) => {\n        console.log('finished');\n        handleVideoEnd(ev);\n    };\n    // const onStateChange = (ev) => {\n    //   switch (ev.data) {\n    //     case 0:\n    //       handleVideoEnd();\n    //   }\n    //   console.log('changed', ev);\n    // };\n    const onPause = (ev) => {\n        console.log('PAUSED', ev);\n        if (videoService.current === 'vimeo') {\n            if (ev.data.duration === ev.data.seconds) {\n                console.log('finished');\n                handleVideoEnd(ev);\n            }\n        }\n    };\n    // @ts-ignore\n    const opts = {\n        height: '390',\n        width: '640',\n        playerVars: {\n        // https://developers.google.com/youtube/player_parameters\n        // autoplay: 1,\n        },\n    };\n    return (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Scrowl.core.Template, { id: `slide-${contentId}`, className: classes, onProgress: handleSlideProgress, onEnd: handleSlideEnd, notScene: disableAnimations ? true : false, ...props },\n        react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { id: contentId, className: \"owlui-container\" },\n            react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: `owlui-row ${alignmentCss}` },\n                react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: `owlui-col text__wrapper` },\n                    react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: \"text__container\" },\n                        react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: \"progress-indictor\" },\n                            react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: \"progress-bar\", style: progressBarStyles })),\n                        react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: `text__value can-focus ${textFocusCss}`, onMouseDown: handleFocusText },\n                            react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Markdown, null, text))))),\n            (videoAssetUrl || videoWebUrl) && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { ref: bgRef, className: `video__wrapper ${alignmentCss} can-focus ${bgFocusCss} ${'as-side'}`, onMouseDown: handleFocusBg },\n                videoWebUrl && !videoAssetUrl && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", null,\n                    videoId && videoService.current === 'youtube' && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_youtube__WEBPACK_IMPORTED_MODULE_4__/* [\"default\"] */ .Z, { videoId: videoId, onPause: onPause, onEnd: onEnd })),\n                    videoId && videoService.current === 'dailymotion' && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_dailymotion__WEBPACK_IMPORTED_MODULE_3__/* [\"default\"] */ .Z, { onEnd: onEnd, video: videoId, autoplay: false, showQueue: false, autoplayQueue: false })),\n                    videoId && videoService.current === 'vimeo' && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react_vimeo__WEBPACK_IMPORTED_MODULE_2___default()), { className: \"vimeo-player\", autoplay: true, videoId: videoId, onEnd: onEnd, paused: true, loop: false, onPause: onPause })))),\n                videoAssetUrl && !videoWebUrl && (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_lazyload__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .ZP, { offset: 250 },\n                    react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"video\", { controls: true, onEnded: handleVideoEnd, className: \"video__container\", \"aria-label\": bgLabel },\n                        react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"source\", { src: videoAssetUrl })))))))));\n};\n\n\n\n//# sourceURL=webpack://@scrowl/template-simple-video/./src/simple-video.tsx?")}}]);